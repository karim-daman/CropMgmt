import{a6 as re,a9 as oe,Z as N,q as w,T as le,_ as fe,g as z,u as ue,aa as ce,ab as H,Y as I,$ as k,a0 as de,ac as j,a7 as B,ad as pe,ae as D,a4 as ee,j as P,af as ve,B as _e,f as O,ag as he,ah as ge,a3 as we,ai as me,aj as be,ak as Ee,al as Ae,W as xe,n as Te,am as ke,an as Le,l as Re,ao as ye,ap as y}from"./ih3xEocW.js";import{f as Ce}from"./DpUOHsiD.js";function Je(e,n){return n}function Ue(e,n,t,a){for(var i=[],s=n.length,c=0;c<s;c++)ge(n[c].e,i,!0);var h=s>0&&i.length===0&&t!==null;if(h){var v=t.parentNode;we(v),v.append(t),a.clear(),A(e,n[0].prev,n[s-1].next)}me(i,()=>{for(var d=0;d<s;d++){var r=n[d];h||(a.delete(r.k),A(e,r.prev,r.next)),be(r.e,!h)}})}function We(e,n,t,a,i,s=null){var c=e,h={flags:n,items:new Map,first:null};{var v=e;c=w?N(le(v)):v.appendChild(re())}w&&fe();var d=null,r=!1,_=ue(()=>{var o=t();return Te(o)?o:o==null?[]:ee(o)});oe(()=>{var o=z(_),u=o.length;if(r&&u===0)return;r=u===0;let l=!1;if(w){var T=c.data===ce;T!==(u===0)&&(c=H(),N(c),I(!1),l=!0)}if(w){for(var b=null,f,p=0;p<u;p++){if(k.nodeType===8&&k.data===de){c=k,l=!0,I(!1);break}var C=o[p],x=a(C,p);f=ne(k,h,b,null,C,x,p,i,n,t),h.items.set(x,f),b=f}u>0&&N(H())}w||Se(o,h,c,i,n,a,t),s!==null&&(u===0?d?j(d):d=B(()=>s(c)):d!==null&&pe(d,()=>{d=null})),l&&I(!0),z(_)}),w&&(c=k)}function Se(e,n,t,a,i,s,c){var h=e.length,v=n.items,d=n.first,r=d,_,o=null,u=[],l=[],T,b,f,p;for(p=0;p<h;p+=1){if(T=e[p],b=s(T,p),f=v.get(b),f===void 0){var C=r?r.e.nodes_start:t;o=ne(C,n,o,o===null?n.first:o.next,T,b,p,a,i,c),v.set(b,o),u=[],l=[],r=o.next;continue}if(Fe(f,T,p),f.e.f&D&&j(f.e),f!==r){if(_!==void 0&&_.has(f)){if(u.length<l.length){var x=l[0],E;o=x.prev;var M=u[0],S=u[u.length-1];for(E=0;E<u.length;E+=1)$(u[E],x,t);for(E=0;E<l.length;E+=1)_.delete(l[E]);A(n,M.prev,S.next),A(n,o,M),A(n,S,x),r=x,o=S,p-=1,u=[],l=[]}else _.delete(f),$(f,r,t),A(n,f.prev,f.next),A(n,f,o===null?n.first:o.next),A(n,o,f),o=f;continue}for(u=[],l=[];r!==null&&r.k!==b;)r.e.f&D||(_??(_=new Set)).add(r),l.push(r),r=r.next;if(r===null)continue;f=r}u.push(f),o=f,r=f.next}if(r!==null||_!==void 0){for(var F=_===void 0?[]:ee(_);r!==null;)r.e.f&D||F.push(r),r=r.next;var ie=F.length;if(ie>0){var se=h===0?t:null;Ue(n,F,se,v)}}P.first=n.first&&n.first.e,P.last=o&&o.e}function Fe(e,n,t,a){ve(e.v,n),e.i=t}function ne(e,n,t,a,i,s,c,h,v,d){var r=(v&Ee)!==0,_=(v&Ae)===0,o=r?_?_e(i):O(i):i,u=v&he?O(c):c,l={i:u,v:o,k:s,a:null,e:null,prev:t,next:a};try{return l.e=B(()=>h(e,o,u,d),w),l.e.prev=t&&t.e,l.e.next=a&&a.e,t===null?n.first=l:(t.next=l,t.e.next=l.e),a!==null&&(a.prev=l,a.e.prev=l.e),l}finally{}}function $(e,n,t){for(var a=e.next?e.next.e.nodes_start:t,i=n?n.e.nodes_start:t,s=e.e.nodes_start;s!==a;){var c=xe(s);i.before(s),s=c}}function A(e,n,t){n===null?e.first=t:(n.next=t,n.e.next=t&&t.e),t!==null&&(t.prev=n,t.e.prev=n&&n.e)}function Ke(e){if(w){var n=!1,t=()=>{if(!n){if(n=!0,e.hasAttribute("value")){var a=e.value;G(e,"value",null),e.value=a}if(e.hasAttribute("checked")){var i=e.checked;G(e,"checked",null),e.checked=i}}};e.__on_r=t,ke(t),Ce()}}function G(e,n,t,a){var i=e.__attributes??(e.__attributes={});w&&(i[n]=e.getAttribute(n),n==="src"||n==="srcset"||n==="href"&&e.nodeName==="LINK")||i[n]!==(i[n]=t)&&(n==="style"&&"__styles"in e&&(e.__styles={}),n==="loading"&&(e[Le]=t),t==null?e.removeAttribute(n):typeof t!="string"&&Ne(e).includes(n)?e[n]=t:e.setAttribute(n,t))}var V=new Map;function Ne(e){var n=V.get(e.nodeName);if(n)return n;V.set(e.nodeName,n=[]);for(var t,a=e,i=Element.prototype;i!==a;){t=ye(a);for(var s in t)t[s].set&&n.push(s);a=Re(a)}return n}function Ie(e,n,t,a){if(typeof n=="function"?e!==n||!0:!n.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(e):a?a.value:n.get(e)}function De(e,n,t,a,i){if(typeof n=="function"?e!==n||!0:!n.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n.set(e,t),t}var U;async function g(e,n={},t){return window.__TAURI_INTERNALS__.invoke(e,n,t)}class Me{get rid(){return Ie(this,U,"f")}constructor(n){U.set(this,void 0),De(this,U,n)}async close(){return g("plugin:resources|close",{rid:this.rid})}}U=new WeakMap;var m;(function(e){e[e.Audio=1]="Audio",e[e.Cache=2]="Cache",e[e.Config=3]="Config",e[e.Data=4]="Data",e[e.LocalData=5]="LocalData",e[e.Document=6]="Document",e[e.Download=7]="Download",e[e.Picture=8]="Picture",e[e.Public=9]="Public",e[e.Video=10]="Video",e[e.Resource=11]="Resource",e[e.Temp=12]="Temp",e[e.AppConfig=13]="AppConfig",e[e.AppData=14]="AppData",e[e.AppLocalData=15]="AppLocalData",e[e.AppCache=16]="AppCache",e[e.AppLog=17]="AppLog",e[e.Desktop=18]="Desktop",e[e.Executable=19]="Executable",e[e.Font=20]="Font",e[e.Home=21]="Home",e[e.Runtime=22]="Runtime",e[e.Template=23]="Template"})(m||(m={}));var Y;(function(e){e[e.Start=0]="Start",e[e.Current=1]="Current",e[e.End=2]="End"})(Y||(Y={}));function ze(e){return{isFile:e.isFile,isDirectory:e.isDirectory,isSymlink:e.isSymlink,size:e.size,mtime:e.mtime!==null?new Date(e.mtime):null,atime:e.atime!==null?new Date(e.atime):null,birthtime:e.birthtime!==null?new Date(e.birthtime):null,readonly:e.readonly,fileAttributes:e.fileAttributes,dev:e.dev,ino:e.ino,mode:e.mode,nlink:e.nlink,uid:e.uid,gid:e.gid,rdev:e.rdev,blksize:e.blksize,blocks:e.blocks}}function He(e){const n=new Uint8ClampedArray(e),t=n.byteLength;let a=0;for(let i=0;i<t;i++){const s=n[i];a*=256,a+=s}return a}class Pe extends Me{async read(n){if(n.byteLength===0)return 0;const t=await g("plugin:fs|read",{rid:this.rid,len:n.byteLength}),a=He(t.slice(-8)),i=t instanceof ArrayBuffer?new Uint8Array(t):t;return n.set(i.slice(0,i.length-8)),a===0?null:a}async seek(n,t){return await g("plugin:fs|seek",{rid:this.rid,offset:n,whence:t})}async stat(){const n=await g("plugin:fs|fstat",{rid:this.rid});return ze(n)}async truncate(n){await g("plugin:fs|ftruncate",{rid:this.rid,len:n})}async write(n){return await g("plugin:fs|write",{rid:this.rid,data:n})}}async function Oe(e,n){if(e instanceof URL&&e.protocol!=="file:")throw new TypeError("Must be a file URL.");const t=await g("plugin:fs|create",{path:e instanceof URL?e.toString():e,options:n});return new Pe(t)}async function $e(e,n){if(e instanceof URL&&e.protocol!=="file:")throw new TypeError("Must be a file URL.");await g("plugin:fs|mkdir",{path:e instanceof URL?e.toString():e,options:n})}async function Ge(e,n){if(e instanceof URL&&e.protocol!=="file:")throw new TypeError("Must be a file URL.");const t=await g("plugin:fs|read_text_file",{path:e instanceof URL?e.toString():e,options:n}),a=t instanceof ArrayBuffer?t:Uint8Array.from(t);return new TextDecoder().decode(a)}async function te(e,n,t){if(e instanceof URL&&e.protocol!=="file:")throw new TypeError("Must be a file URL.");const a=new TextEncoder;await g("plugin:fs|write_text_file",a.encode(n),{headers:{path:encodeURIComponent(e instanceof URL?e.toString():e),options:JSON.stringify(t)}})}async function q(e,n){if(e instanceof URL&&e.protocol!=="file:")throw new TypeError("Must be a file URL.");return await g("plugin:fs|exists",{path:e instanceof URL?e.toString():e,options:n})}const J=y([{name:"Cnh",cards:[]},{name:"Goweil",cards:[]},{name:"General",cards:[]}]),W=y([{name:"Cnh",cards:[]},{name:"Goweil",cards:[]}]),K=y([]),X=y([]),Z=y([]);async function ae(){await q("data",{baseDir:m.Desktop})||(console.log("Data folder does not exist, creating one.."),await $e("data",{baseDir:m.Desktop}));const n=["achats.txt","clients.txt","entretiens.txt","livraisons.txt","pointages.txt"];for(const t of n){const a=`data\\${t}`;if(!await q(a,{baseDir:m.Desktop})){const s=await Oe(a,{baseDir:m.Desktop});await te(a,"[]",{baseDir:m.Desktop}),await s.close()}}}async function L(e,n){if(await ae(),!!e)try{await te(`data\\${n}.txt`,JSON.stringify(e,null,2),{baseDir:m.Desktop})}catch(t){console.error(`Error saving ${n}:`,t)}}async function R(e){await ae(),console.log("Loading data from file ..");try{const n=await Ge(`data\\${e}.txt`,{baseDir:m.Desktop});return JSON.parse(n)}catch(n){return console.error(`Error loading ${e}:`,n),[]}}async function Ve(){try{const[e,n,t,a,i]=await Promise.all([R("achats"),R("clients"),R("entretiens"),R("livraisons"),R("pointages")]);return{achatsData:e,clientsData:n,entretiensData:t,livraisonsData:a,pointagesData:i}}catch(e){return console.error("Error loading stores:",e),{achatsData:[],clientsData:[],entretiensData:[],livraisonsData:[],pointagesData:[]}}}let Q=!1;async function Xe(){if(!Q){try{const{achatsData:e,clientsData:n,entretiensData:t,livraisonsData:a,pointagesData:i}=await Ve();J.set(e),K.set(n),W.set(t),X.set(a),Z.set(i),J.subscribe(s=>L(s,"achats")),K.subscribe(s=>L(s,"clients")),W.subscribe(s=>L(s,"entretiens")),X.subscribe(s=>L(s,"livraisons")),Z.subscribe(s=>L(s,"pointages"))}catch(e){console.error("Error initializing stores:",e)}Q=!0}}export{Je as a,W as b,K as c,J as d,We as e,Xe as i,X as l,Z as p,Ke as r,G as s};
